<div class="reports-container">
    <header class="page-header">
        <div class="header-info">
            <h2 class="text-gradient">Financial Reports</h2>
            <p class="text-muted">In-depth annual analysis for <strong>{{ selectedYear }}</strong></p>
        </div>
        <div class="custom-selector" (mouseleave)="showYearMenu = false">
            <button class="selector-trigger" (click)="showYearMenu = !showYearMenu">
                {{ selectedYear }} Report <i class="bi bi-chevron-down"></i>
            </button>
            <ul class="selector-options" *ngIf="showYearMenu">
                <li *ngFor="let y of years" [class.active]="y === selectedYear"
                    (click)="selectedYear = y; onYearChange(); showYearMenu = false">
                    {{ y }} Report
                </li>
            </ul>
        </div>
    </header>

    <div class="reports-grid" *ngIf="isLoaded">
        <section class="report-card glass-card span-full">
            <div class="card-header">
                <h3><i class="bi bi-calendar-range"></i> Monthly Cash Flow ({{ selectedYear }})</h3>
                <span class="badge">Annual Comparison</span>
            </div>
            <div class="chart-container">
                <canvas baseChart [data]="barChartData" [options]="barChartOptions" type="bar"></canvas>
            </div>
        </section>

        <section class="report-card glass-card">
            <div class="card-header">
                <h3><i class="bi bi-shield-check"></i> Analysis Radar</h3>
            </div>
            <div class="chart-container radar-container">
                <canvas baseChart [data]="radarChartData" [options]="{ responsive: true, maintainAspectRatio: false }"
                    type="radar"></canvas>
            </div>
        </section>

        <section class="report-card glass-card info-card">
            <div class="card-header">
                <h3><i class="bi bi-lightbulb-fill"></i> Smart Insights</h3>
            </div>
            <div class="insights-list">
                <div class="insight-item">
                    <div class="insight-icon success"><i class="bi bi-check-lg"></i></div>
                    <div class="insight-content">
                        <strong>Savings Status</strong>
                        <p>Your performance in <strong>{{ selectedYear }}</strong> shows a healthy growth trend.</p>
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-icon warning"><i class="bi bi-exclamation-triangle"></i></div>
                    <div class="insight-content">
                        <strong>Expense Alert</strong>
                        <p>Categories like <strong>food</strong> represent 25% of your yearly costs.</p>
                    </div>
                </div>
                <div class="insight-item">
                    <div class="insight-icon info"><i class="bi bi-info-circle"></i></div>
                    <div class="insight-content">
                        <strong>Pro Tip</strong>
                        <p>Switching to quarterly analysis can reveal deeper saving patterns.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div class="loading-state" *ngIf="!isLoaded">
        <div class="spinner"></div>
        <p>Generating your {{ selectedYear }} report...</p>
    </div>

    <div class="empty-state" *ngIf="isLoaded && transactions.length === 0">
        <i class="bi bi-bar-chart" style="font-size: 3rem; opacity: 0.2; margin-bottom: 1rem;"></i>
        <p>No transactions found for the year {{ selectedYear }}.</p>
    </div>
</div>